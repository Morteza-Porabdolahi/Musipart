async function getAllMusics(){const e="https://haji-api.ir/music?q=";try{const t=[fetch(`${e}week`),fetch(`${e}new`)],n=await Promise.all(t),s=[];for(let e=0;e<n.length;e++)s.push((await n[e].json()).results);window.allResults=sortResultsWithPopularity(s.flat()),manipulateData()}catch(e){e&&(hidePreloader(),showAlert("error","Something went Wrong !"),setTimeout(hideAlert,1e3))}}function sortResultsWithPopularity(e=[]){return e.forEach((e=>{const t=e.downloadCount.includes("M"),n=+e.downloadCount.split(t?"M":"k")[0];e.downloadCount=t?1e6*n:1e4*n})),e.sort(((e,t)=>t.downloadCount-e.downloadCount))}function manipulateData(){clickedCount++;createHTMLElementsFromData(allResults.slice().splice(clickedCount*perClick-perClick,perClick))}window.addEventListener("load",getAllMusics);const songsWrapper=document.createElement("div");function createHTMLElementsFromData(e=[]){let t;e.forEach((e=>{t=`\n            <div class="music-card">\n                <div class="music-card__img-container">\n                    <img class="music-card__img" loading="lazy" src="${e.image.cover.url}" />\n                    <button class="music-card__play-btn" onclick="playEntireMusic(event,'${e.id}')">\n                      <img src="/assets/icons/play-mini-line.svg"/>\n                    </button>\n                </div>\n                <div class="music-card__informations">\n                    <a href="/pages/singlemusicpage.html?id=${e.id}" class="informations__music-name">${e.title}</a>  \n                    ${e.artists.map((e=>`<a class="informations__music-artist" href="/pages/artistmusics.html?q=${e.fullName}">${e.fullName}</a>`))}\n                </div>\n            </div>`,songsWrapper.insertAdjacentHTML("beforeend",t)})),1===clickedCount&&appendContainerIntoDom(songsWrapper)}function appendContainerIntoDom(e){document.querySelector(".allmusics").appendChild(e),loadMoreBtn.style.display="block",hidePreloader()}songsWrapper.className="allmusics-section";
